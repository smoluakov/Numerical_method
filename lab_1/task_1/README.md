# Системы линейных алгебраических уравнений. Метод Гаусса



Кратко говоря, алгоритм заключается в последовательном исключении переменных из каждого уравнения до тех пор, пока в каждом уравнении не останется только по одной переменной. Если n=m, то можно говорить, что алгоритм Гаусса-Жордана стремится привести матрицу A системы к единичной матрице — ведь после того как матрица стала единичной, решение системы очевидно — решение единственно и задаётся получившимися коэффициентами b_i.

При этом алгоритм основывается на двух простых эквивалентных преобразованиях системы: во-первых, можно обменивать два уравнения, а во-вторых, любое уравнение можно заменить линейной комбинацией этой строки (с ненулевым коэффициентом) и других строк (с произвольными коэффициентами).

На первом шаге алгоритм Гаусса-Жордана делит первую строку на коэффициент a_{11}. Затем алгоритм прибавляет первую строку к остальным строкам с такими коэффициентами, чтобы их коэффициенты в первом столбце обращались в нули — для этого, очевидно, при прибавлении первой строки к i-ой надо домножать её на -a_{i1}. При каждой операции с матрицей A (деление на число, прибавление к одной строке другой) соответствующие операции производятся и с вектором b; в некотором смысле, он ведёт себя, как если бы он был m+1-ым столбцом матрицы A.

В итоге, по окончании первого шага первый столбец матрицы A станет единичным (т.е. будет содержать единицу в первой строке и нули в остальных).

Аналогично производится второй шаг алгоритма, только теперь рассматривается второй столбец и вторая строка: сначала вторая строка делится на a_{22}, а затем отнимается от всех остальных строк с такими коэффициентами, чтобы обнулять второй столбец матрицы A.

И так далее, пока мы не обработаем все строки или все столбцы матрицы A. Если n=m, то по построению алгоритма очевидно, что матрица A получится единичной, что нам и требовалось.


# Поиск опорного элемента (pivoting)
Разумеется, описанная выше схема неполна. Она работает только в том случае, если на каждом i-ом шаге элемент a_{ii} отличен от нуля — иначе мы просто не сможем добиться обнуления остальных коэффициентов в текущем столбце путём прибавления к ним i-ой строки.

Чтобы сделать алгоритм работающим в таких случаях, как раз и существует процесс выбора опорного элемента (на английском языке это называется одним словом "pivoting"). Он заключается в том, что производится перестановка строк и/или столбцов матрицы, чтобы в нужном элементе a_{ii} оказалось ненулевое число.

Заметим, что перестановка строк значительно проще реализуется на компьютере, чем перестановка столбцов: ведь при обмене местами двух каких-то столбцов надо запомнить, что эти две переменных обменялись местами, чтобы затем, при восстановлении ответа, правильно восстановить, какой ответ к какой переменной относится. При перестановке строк никаких таких дополнительных действий производить не надо.

К счастью, для корректности метода достаточно одних только обменов строк (т.н. "partial pivoting", в отличие от "full pivoting", когда обмениваются и строки, и столбцы). Но какую же именно строку следует выбирать для обмена? И правда ли, что поиск опорного элемента надо делать только тогда, когда текущий элемент a_{ii} нулевой?

Общего ответа на этот вопрос не существует. Есть разнообразные эвристики, однако самой эффективной из них (по соотношению простоты и отдачи) является такая эвристика: в качестве опорного элемента следует брать наибольший по модулю элемент, причём производить поиск опорного элемента и обмен с ним надо всегда, а не только когда это необходимо (т.е. не только тогда, когда a_{ii}=0).

Иными словами, перед выполнением i-ой фазы алгоритма Гаусса-Жордана с эвристикой partial pivoting необходимо найти в i-ом столбце среди элементов с индексами от i до n максимальный по модулю, и обменять строку с этим элементом с i-ой строкой.

Во-первых, эта эвристика позволит решить СЛАУ, даже если по ходу решения будет случаться так, что элемент a_{ii}=0. Во-вторых, что весьма немаловажно, эта эвристика улучшает численную устойчивость алгоритма Гаусса-Жордана.

Без этой эвристики, даже если система такова, что на каждой i-ой фазе a_{ii} \ne 0 — алгоритм Гаусса-Жордана отработает, но в итоге накапливающаяся погрешность может оказаться настолько огромной, что даже для матриц размера около 20 погрешность будет превосходить сам ответ.
